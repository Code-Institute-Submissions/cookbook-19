{% extends 'base.html' %} {% block content %}
<section>
    <!---List of recipes returned from DB --->
    <div class="recipe-list-header">
        <div class="row">
            <div class="col s2 offset-s1 ">
                <p class="center-align"></p>
            </div>
            <div class="col s4 valign_wrapper">
                <p class="left-align"><i class="material-icons tiny">arrow_drop_down</i>Name</p>
            </div>
            <div class="col s2">
                <p class="left-align"><i class="material-icons tiny">arrow_drop_down</i>Time</p>
            </div>
            <div class="col s3">
                <p class="left-align"><i class="material-icons tiny">arrow_drop_down</i>Difficulty</p>
            </div>
        </div>
    </div>
    <div class="recipe_list row-effect">
        {% for recipe in recipes %}
        {% if action=="edit" %}
        <a href="{{url_for('edit_recipe', recipe_id=recipe._id)}}">
        {% elif action=="delete" %}        
        <a href="#delete_modal" class="modal-trigger delete_button" recipe_id={{recipe._id}}>
        {% else %}        
        <a href="{{url_for('show_recipe', recipe_id=recipe._id)}}">
        {% endif %}
        <div class="row valign-wrapper">
            <div class="col s1">
                {% if action=="edit" %}
                  <p><i class="material-icons">edit</i></p>
                {% elif action=="delete" %}
                  <p><i class="material-icons">delete_forever</i></p>              
                {% elif recipe.favourite %}
                    <p><i class="material-icons gold-star">star</i></p>
                {% else %}
                    <p><i class="material-icons">star_border</i></p>
                {% endif %}
            </div>
            <div class="col s2">
                {% if recipe.picture %}
                <p class="center-align"><img src="{{recipe.picture}}"></p>
                {% else %}
                <p class="center-align"><i class="fa fa-cutlery fa-2x" aria-hidden="true"></i></p>
                {% endif %}
            </div>
            <div class="col s4">

                <p>{{ recipe.name[0]|upper }}{{ recipe.name[1:]}}</p>
            </div>
            <div class="col s2">

                <p class="center-align">
                    {% if recipe.hours > 0 %} 
                    {{recipe.hours}}h 
                    {%endif%} 
                    {% if recipe.minutes > 0 %} 
                    {{recipe.minutes}}m
                </p>
                {% endif %}
            </div>
            <div class="col s3">
                {% if recipe.difficulty %}
                <p class="center-align">{{ recipe.difficulty[0]|upper }}{{ recipe.difficulty[1:]|lower}}</p>
                {%endif%}
            </div>
        </div>
        </a>
        {% endfor %}
    </div>
</section>

<!--Deletion modal -->
<section>
  <div id="delete_modal" class="modal">
    <div class="modal-content">
      <h4>Confirm deletion</h4>
      <p>Are you sure you want to delete this recipe?</p>

        <form action="{{url_for('delete_recipe') }}"method="POST">
            <input type="hidden" name="recipe_id" id="recipe_id_input"></input>
            <div class="row">
                <div class="col s5">
                    <button type="reset" id="modal_reset" class="modal-close waves-effect waves-green btn-flat highlight1-background" style="padding: 0 6px 0 6px; width:100px">
                        <i class="fa fa-times-circle" class="float:left"aria-hidden="true"></i>
                        <p style="margin:0; padding:0 6px 0 6px; float:right; color:white"> Cancel</p>
                    </button>
                </div>
                <div class="col s5 offset-s1">
                    <button type="submit" class="modal-close waves-effect waves-green btn-flat" style="background-color: red; padding: 0 6px 0 6px; width:100px">
                        <i class="fa fa-times-circle" class="float:left"aria-hidden="true"></i>
                        <p style="margin:0; padding:0 6px 0 6px; float:right; color:white"> Delete</p>
                    </button>
            </div>
        </form>      
    </div>
  </div>
</section>  
 
 <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
 <script>

    $('body').on('click','.delete_button', function() {
        recipe_id=$(this).attr("recipe_id");
        $('#recipe_id_input').val(recipe_id)
        $(this).find(".row").addClass("selected-for-deletion")
   //     $(this).find(".row").css({"background-color":"red","color":"white"})
        $('#modal_reset').data("row_to_delete",$(this).find(".row"))
    })   
    
    $('#modal_reset').on('click', function() {
        var row=$(this).data("row_to_delete");
        console.log(row)
        row.removeClass("selected-for-deletion");
    })
    
 </script>

{% endblock %}
