{"changed":true,"filter":false,"title":"add_recipe.html","tooltip":"/templates/add_recipe.html","value":"{% extends 'base.html' %} {% block content %}\n\n<!-- call to action -->\n<!-- Add recipe form -->\n<section>\n  <div class=\"row\">\n    <!--set the edit variable to false to tell flask this is a new recipe being added so no need to request the recipe_id-->\n    <form id=\"recipe-form\" action=\"{{url_for('insertrecipe', edit='False') }}\" method=\"POST\" class=\"col s12\">\n      <div class=\"row\">\n        <div class=\"col s10 offset-s1\">\n          <div class=\"row\">\n            <div class=\"col s10 input-field\">\n              <input id=\"name\" name=\"name\" type=\"text\" label=\"Name\" required></input>\n              <label for=\"name\">Name</label>\n            </div>\n            <div class=\"col s2 valign-wrapper\">\n              {%if session[\"user\"] %}\n              <p id=\"favourite\"><i id=\"star\" class=\"material-icons\">star_border</i></p>\n              {%endif%}\n              <input type=\"hidden\" id=\"favourite_input\" name=\"favourite\" value=false></input>\n            </div>\n          </div>\n\n          <div class=\"row\">\n            <div class=\"col s12 input-field\">\n              <label for=\"country\">Country of origin</label>\n              <input id=\"country\" name=\"country\" type=\"text\"></input>\n            </div>\n          </div>\n\n          <div class=\"row\">\n            <div class=\"col s12 input-field\">\n              <label for=\"author\">Recipe Author</label>\n              <input id=\"author\" class=\"autocomplete\" name=\"author\" type=\"text\" value=\"{{session[\"user\"]}}\"></input>\n            </div>\n          </div>\n\n          <div class=\"row\">\n            <div class=\"col s12\">\n              <label for=\"picture\">Picture</label>\n              <input id=\"picture\" name=\"picture\" type=\"text\" placeholder=\"type in full URL of image\"></input>\n            </div>\n          </div>\n\n          <div class=\"row \">\n            <div class=\"col s6\">\n              <label for=\"meal\">Meal</label>\n              <div class=\"input-field\">\n                <select name=\"meal\">\n              <option value=\"\" disabled selected>Select</option>\n              <option value=\"breakfast\">BREAKFAST</option>\n              <option value=\"lunch\">LUNCH</option>\n              <option value=\"dinner\">DINNER</option>\n              <option value=\"snack\">SNACK</option>\n            </select>\n              </div>\n            </div>\n\n            <div class=\"col s6\">\n              <label for=\"difficulty\">Difficulty</label>\n              <div class=\"input-field\">\n                <select name=\"difficulty\">\n              <option value=\"\" disabled selected>Select</option>\n              <option value=\"easy\">EASY</option>\n              <option value=\"medium\">MEDIUM</option>\n              <option value=\"hard\">HARD</option>\n            </select>\n              </div>\n            </div>\n          </div>\n\n          <div class=\"row\">\n            <div class=\"col s6\">\n              <label for=\"hours\">Cooking Time</label>\n            </div>\n            <div class=\"col s3 offset-s3\">\n              <label for=\"calories\">Calories</label>\n            </div>\n          </div>\n          <div class=\"row\">\n            <div class=\"col s3\">\n              <input name=\"hours\" type=\"number\" placeholder=\"hours\"></input>\n            </div>\n            <div class=\"col s3\">\n              <input name=\"minutes\" type=\"number\" placeholder=\"minutes\"></input>\n            </div>\n            <div class=\"col s3 offset-s3\">\n              <input name=\"calories\" type=\"number\" placeholder=\"calories\"></input>\n            </div>\n          </div>\n\n          <div class=\"row \">\n            <div class=\"col s12\">\n              <p>Ingredients</p>\n            </div>\n          </div>\n          <div class=\"row\">\n            <div class=\"col s5 input-field\">\n                  <input class=\"autocomplete\" id=\"ingredient\" type=\"text\"></input> \n              <label for=\"ingredient\">Ingredient</label>\n                  \n            </div>\n            <div class=\"col s3 input-field\">\n              <input id=\"amount\" type=\"number\" min=\"0\">\n              <label for=\"amount\">Quantity</label>\n              \n            </div>\n            <div class=\"col s2\" style=\"padding-right:2px\">\n              <div id=\"unit\" class=\"input-field\">\n                <select id=\"select-unit\">\n              <option value=\"\" selected=\"selected\"> </option>\n              <option value=\"g\">g</option>\n              <option value=\"kg\">kg</option>\n              <option value=\"ml\">ml</option>\n              <option value=\"ltr\">ltr</option>\n              <option value=\"tsp\">tsp</option>\n              <option value=\"tbsp\">tbsp</option>\n            </select>\n            <label>Unit</label>\n              </div>\n            </div>\n            <div class=\"col s1\">\n              <a id=\"add_ingredient\" class=\"btn-floating btn-small waves-effect waves-light highlight3-background\"><i class=\"material-icons\">add</i></a>\n            </div>\n          </div>\n          <div id=\"ingredients\">\n          </div>\n          <div class=\"row \">\n            <div class=\"col s12\">\n              <label for=\"select_allergens\">Allergens</label>\n              <div class=\"input-field\">\n                <select name=\"allergens\" id=\"select_allergens\" multiple>\n              <option value=\"dairy\">DAIRY</option>\n              <option value=\"fish\">FISH</option>\n              <option value=\"gluten\">GLUTEN</option>\n              <option value=\"nuts\">NUTS</option>\n              <option value=\"shellfish\">SHELLFISH</option>\n              <option value=\"eggs\">EGGS</option>\n              <option value=\"meat\">MEAT</option>\n            </select>\n              </div>\n            </div>\n          </div>\n\n          <div class=\"row\">\n            <div class=\"col s12 input-field\" style=\"margin-top:10px\">\n              <label for=\"method\">Method</label>\n              <textarea id=\"method\" name=\"method\" class=\"materialize-textarea\" label=\"method\" required></textarea>\n            </div>\n          </div>\n\n        </div>\n      </div>\n      <div class=\"row\">\n        <div class=\"col s4 offset-s1 m2 offset-m3 \">\n          <a href=\"{{url_for('index')}}\" class=\"waves-effect waves-light btn btn-block hide-on-med-and-up highlight4-background\">Home</a>\n          <a href=\"{{url_for('index')}}\" class=\"waves-effect waves-light btn-large btn-block hide-on-small-only highlight4-background\">Home</a>\n        </div>\n        <div class=\"col s4 offset-s2 m2 offset-m2 \">\n          <a id=\"submit-recipe\" class=\"waves-effect waves-light btn btn-block hide-on-med-and-up highlight2-background\">Add</a>\n          <a id=\"submit-recipe\" class=\"waves-effect waves-light btn-large btn-block hide-on-small-only highlight2-background\">Add</a>\n        </div>\n      </div>\n    </form>\n  </div>\n</section>\n\n<!--Error modal -->\n<section>\n  <div id=\"error-modal\" class=\"modal\">\n    <div class=\"modal-content\">\n      <h4>Error</h4>\n      <p>Please input </p>\n    </div>\n    <div class=\"modal-footer\">\n      <a href=\"#!\" class=\"modal-close waves-effect waves-light btn-flat background-highlight3\">OK</a>\n    </div>\n  </div>\n</section>\n\n\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js\"></script>\n<script type=\"text/javascript\">\n  $(document).ready(function() {\n    var ingredient_list={{ingredients_list|tojson}}\n    var author_list={{author_list|tojson}}\n    var country_list={{country_list|tojson}}\n      \n    $('#ingredient').autocomplete({\n      data:ingredient_list,\n    });\n    $('#author').autocomplete({\n      data:author_list,\n    }); \n    $('#country').autocomplete({\n      data:country_list,\n    });         \n      \n  })\n\n  $(\"#add_ingredient\").on(\"click\", function() {\n    var totalIngredients = $(\"#ingredients\").data(\"total_ingredients\");\n    totalIngredients++;\n    $(\"#ingredients\").data(\"total_ingredients\", totalIngredients);\n    var currentIngredient = $(\"#ingredient\").val();\n    var currentAmount = $(\"#amount\").val();\n    var currentUnit = $(\"#unit option:selected\").val()\n    var currentIngredients = $(\"#ingredients\").html()\n    //build an array of current ingredients, to check against the current ingredient being entered to throw an error if a duplicate ingredient is added.\n    var ingredientList=[];\n    $(\".ingredient-type\").each(function(i,object) {\n      ingredientList[i]=$(object).attr(\"value\");\n    })\n    \n    //check if amount of ingredients has been entered - check against whether a number is input and whether string is empty\n    if (isNaN(currentAmount) || currentAmount.length == 0 || currentAmount == undefined) {\n      //display error modal\n      $(\"#error-modal p\").text(\"Please enter amount of ingredients\")\n      $(\"#error-modal\").modal('open');\n    }\n    else if (currentIngredient.length == 0 || currentIngredient == undefined) {\n      //display error modal\n      $(\"#error-modal p\").text(\"Please enter ingredient name\")\n      $(\"#error-modal\").modal('open');\n    }\n    //check the ingredient being added against the current ingredients. If duplicate, display error modal.\n    else if(ingredientList.indexOf(currentIngredient)!=-1) {\n      $(\"#error-modal p\").text(\"You have entered a duplicate ingredient. Check and try again.\")\n      $(\"#error-modal\").modal('open');      \n    }\n    else {\n      if (currentUnit === \"0\") { currentUnit = \"\" }\n      console.log(currentIngredient)\n      $(\"#ingredients\").html(currentIngredients + \"<div class='row'><div class='col s1 valign-wrapper'><p>\" + currentAmount + \"</p></div><div class='col s2 valign-wrapper'><p>\" + currentUnit + \"</p></div><div class='col s7'><p>\" + currentIngredient + \" </p></div><div class='col s1'><a id='remove_ingredient' class='btn-floating btn-small waves-effect waves-light highlight3-background'><i class='material-icons'>delete</i></a></div></div><input id='ingredd' class='ingredient-type' type='hidden' name='type' value='\" + currentIngredient + \"'></input><input type='hidden' name='amount' value=\" + currentAmount + \"></input><input type='hidden' name='unit' value=\" + currentUnit + \"></input>\")\n      $(\"#ingredient\").val('');\n      $(\"#amount\").val('');\n      $(\"#select-unit\").val('');\n      $('#select-unit').formSelect();\n      console.log(\"value \",$(\"#ingredd\").val())\n    }\n  });\n\n  $('body').on(\"click\", \"#remove_ingredient\", function() {\n    $(this).parent().parent().slideUp(500);\n    setTimeout(function() { $(this).parent().parent().remove(); }, 500);\n  });\n  \n  $(\"#submit-recipe\").on(\"click\", function() {\n    var name=$(\"#name\").val();\n    var ingredient=$('#ingredients').find('input').filter(':hidden:first').val();\n    var method=$('#method').val();\n    if(name==\"\") {\n      $(\"#error-modal p\").text(\"You need to name your recipe\")\n      $(\"#error-modal\").modal('open');\n    }\n    else if(ingredient==undefined || ingredient==\"\"){\n      $(\"#error-modal p\").text(\"You need at least one ingredient for your recipe\")\n      $(\"#error-modal\").modal('open');      \n    }\n    else if(method==\"\"){\n      $(\"#error-modal p\").text(\"You need to provide instructions as to how to make your recipe\")\n      $(\"#error-modal\").modal('open');      \n    }\n    else {\n      $(\"#recipe-form\").submit();  \n    }\n  })\n  \n    \n\n\n</script>\n\n{% endblock %}\n","undoManager":{"mark":-2,"position":2,"stack":[[{"start":{"row":184,"column":1},"end":{"row":184,"column":2},"action":"insert","lines":["/"],"id":67},{"start":{"row":184,"column":2},"end":{"row":184,"column":3},"action":"insert","lines":["/"]}],[{"start":{"row":183,"column":32},"end":{"row":184,"column":31},"action":"remove","lines":[""," //   $('select').formSelect();"],"id":68}],[{"start":{"row":184,"column":4},"end":{"row":185,"column":0},"action":"remove","lines":["",""],"id":69},{"start":{"row":184,"column":4},"end":{"row":184,"column":6},"action":"remove","lines":["  "]},{"start":{"row":184,"column":4},"end":{"row":184,"column":6},"action":"remove","lines":["  "]}]]},"ace":{"folds":[],"scrolltop":2944.444580078125,"scrollleft":0,"selection":{"start":{"row":48,"column":17},"end":{"row":48,"column":23},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":true,"wrapToView":false},"firstLineState":{"row":515,"mode":"ace/mode/html"}},"timestamp":1565122801567}